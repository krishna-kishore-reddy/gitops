global:  #here the name of the secret should be the same as the exising one which installed by default with the kube pormethues stack helm chart
  resolve_timeout: 5m
inhibit_rules:
- equal:
  - namespace
  - alertname
  source_matchers:
  - severity = critical
  target_matchers:
  - severity =~ warning|info
- equal:
  - namespace
  - alertname
  source_matchers:
  - severity = warning
  target_matchers:
  - severity = info
- equal:
  - namespace
  source_matchers:
  - alertname = InfoInhibitor
  target_matchers:
  - severity = info
- target_matchers:
  - alertname = InfoInhibitor
receivers:
- name: "slack"
  slack_configs:
    - api_url: ${SLACK_WEBHOOK_URL}
      channel: '#alerts'
      send_resolved: true
      title: |-
        🚨 [{{ .Status | toUpper }}] {{ .CommonLabels.alertname }} ({{ .CommonLabels.severity | toUpper }})
      text: |-
        *🌍 Cluster:* my-k8s-cluster
        *📦 Namespace:* `{{ .CommonLabels.namespace }}`
        *🔹 Pod:* `{{ .CommonLabels.pod }}`
        *⚠️ Severity:* `{{ .CommonLabels.severity }}`
        *📝 Summary:* {{ .CommonAnnotations.summary }}
        *📖 Description:* {{ .CommonAnnotations.description }}

        *⏱ Starts At:* {{ (index .Alerts 0).StartsAt }}
        *🔚 Ends At:* {{ (index .Alerts 0).EndsAt }}
        
        👉 <http://alertmanager.inarm.in|View in Alertmanager>

route:
  group_by:
  - namespace
  group_interval: 5m
  group_wait: 30s
  receiver: "slack"
  repeat_interval: 12h
  routes:
    - matchers:
        - severity = critical|warning|info
      receiver: "slack"
templates:
- /etc/alertmanager/config/*.tmpl
